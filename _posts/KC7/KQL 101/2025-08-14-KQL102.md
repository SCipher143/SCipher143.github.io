---
layout: post
title: "Valdoria Votes ‚Äì KC7 Cyber Challenge"
date: 2025-08-14 10:00:00 -0700
categories: [SOC, Blue Team, Threat Hunting]
tags: [KC7, KQL, Microsoft Sentinel, Detection, Blue Team, Election Security]
description: Navigate the tension-filled cybersecurity scenario of an election under threat in ‚ÄúValdoria Votes.‚Äù Enhance your KQL skills as you investigate infiltration attempts aimed at undermining the voting process.
---

## üîç Overview

The **What's a query?** section is the first part of the [KC7 Cyber Challenge Module 335](https://kc7cyber.com/challenges/335).

### üìö Module Structure

This challenge is divided into five parts:
1. **What's a query** 
2. **All about the dataz**
3. **A vote of no confidence**
4. **Snooping Around**
5. **Look on my [Security], ye Mighty, and despair!**

Each section builds on the last. For example, you may uncover an IP address or user account in one task that becomes the key to solving several others.

---

## What's a query

Let's Get Familiar with the team at Valdoria Board of Elections.

The Employees table contains information about all the staff who are part of the Valdoria Board of Elections.

We'll use KQL (Kusto Query Language) queries to explore our data. Don‚Äôt worry, we‚Äôll provide you with some queries to get started with the game.

For each query we provide, you can simply copy and paste it into the query pane on the right, and then click run.

#### What is the name of the Deputy Commissioner?

![Desktop View](/assets/img/KQL102/1.png){: width="700" height="400" }

`Hilary Binton`

#### What is Dora Thomas' role?

![Desktop View](/assets/img/KQL102/2.png){: width="700" height="400" }

`Polling Station Supervisor`

#### What is this supervisor's name?

![Desktop View](/assets/img/KQL102/3.png){: width="700" height="400" }

`Barry Schmelly`

#### What is Barry Schmelly's IP address

`10.10.0.12`

#### What is Barry Schmelly's hostname

`GCH3-DESKTOP`

#### What is Barry Schmelly's email address?

`barry_schmelly@valdoriavotes.gov`

#### How many emails did Barry Schmelly receive?

![Desktop View](/assets/img/KQL102/4.png){: width="700" height="400" }

`37`

#### How many distinct commands were run on Barry Schmelly's machine?

![Desktop View](/assets/img/KQL102/5.png){: width="700" height="400" }

---

Sometimes, you‚Äôll want to look at multiple items at once in another table. You can‚Äôt be expected to type all of those items by hand, or even to look for them one by one. That‚Äôs where let statements can save you time! A let statement allows you to save values in a variable that you can then access easily by calling the variable in your query. Let‚Äôs try an example.

What if we wanted to see all the URLs browsed by employees with the name William? To find it we‚Äôd need to find all their IP addresses. But there are so many Williams! Instead of typing each one in separately, we can save the IP addresses in a let statement, like so:

---

#### How many distinct URLs did employees with the first name William visit?

![Desktop View](/assets/img/KQL102/6.png){: width="700" height="400" }

`217`

#### How many authentication attempts did we see to the accounts of employees with the first name William?

![Desktop View](/assets/img/KQL102/7.png){: width="700" height="400" }

`183`

---

By grabbing just the first 10 rows, you can get an overview of the structure and contents without having to sift through massive amounts of data. This helps you decide where to focus your investigation and identify any key patterns or anomalies early on.

#### What IP address did they forget to hide in the poster?

`55.49.227.170`

![Desktop View](/assets/img/KQL102/8.png){: width="700" height="400" }

#### Is there any evidence of traffic from this IP address to our network? (yes/no)

![Desktop View](/assets/img/KQL102/9.png){: width="700" height="400" }

---

PassiveDNS is a tool that keeps a record of which domain names (like websites) have been connected to specific IP addresses over time. This allows us to look back and see which websites or services might have used a particular IP, helping us track any suspicious or malicious activity

#### How many domains resolved to the IP 55.49.**.***?

`2`

![Desktop View](/assets/img/KQL102/10.png){: width="700" height="400" }

#### What is the Valdoria related domain resolving to that IP?

`valdoriavotesgov.com`

#### What is the legitimate domain for the Valdoria Elections Board?

`valdoriavotes.gov`

---

Let‚Äôs pivot on the fake Valdoria domain to see if it‚Äôs been associated with other IPs.

#### How many IP addresses did the fraudulent Valdoria government domain resolve to?

![Desktop View](/assets/img/KQL102/11.png){: width="700" height="400" }

#### Which table should we be looking at for records of that kind of activity again?

`InboundNetworkEvents`

#### How many requests do we see to our network from those IPs?

