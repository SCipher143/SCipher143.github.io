---
layout: post
title: "KQL 101, A Scandal in Valdoria ‚Äì KC7 Cyber Challenge"
date: 2025-07-18 10:00:00 -0700
categories: [SOC, Blue Team, Threat Hunting]
tags: [KC7, KQL, Microsoft Sentinel, Detection, Blue Team]
description: Build your KQL skills in the KC7 Cyber Challenge by working through real-world threat hunting scenarios. Master the basics of querying with KQL and learn how to pivot through logs to uncover suspicious activity.
---

## üîç Overview

The **KQL 101** section is the first part of the [KC7 Cyber Challenge Module 132](https://kc7cyber.com/challenges/132), introducing foundational concepts for querying logs with **Kusto Query Language (KQL)**. This module sets the stage for the rest of the challenge, walking you through how to investigate events using real-world log formats.

### üìö Module Structure

This challenge is divided into four parts:
1. **KQL 101** 
2. Welcome to Valdoria!
3. Plenty of Phish
4. A Scandal

Each section builds on the last. For example, you may uncover an IP address or user account in one task that becomes the key to solving several others.

### üõ†Ô∏è Skills Practiced

- Writing basic and advanced **KQL queries**
- Using tables like `SigninLogs`, `DeviceLogonEvents`, etc.
- Filtering and projecting fields
- Pivoting on IoCs (IP addresses, usernames, hostnames)
- Log correlation and event tracing

### üß™ What You'll Learn

By the end of this section, you'll be able to:
- Query effectively in Microsoft Sentinel
- Identify suspicious logon behavior
- Track user and device activity through logs
- Use summarization and visualization techniques for analysis

### ‚úÖ Completion Notes

The **KQL 101** section is a great primer for new threat hunters or SOC analysts looking to sharpen their detection and log analysis skills in a Microsoft ecosystem. Everything learned here plays a role in uncovering deeper threats in the upcoming sections of the challenge.

---

## Intro: Welcome to Valdoria!

On the eve of the election, Nene Leaks, the esteemed editor of The Valdorian Times, awoke to a nightmare. The Valdorian Times, the beacon of truth for the city, published a scandalous article accusing Luffy of corruption and misconduct. The article, a vile concoction of lies, was not what she had approved.

The article alleged that Luffy, hailed for his environmental activism and social reforms, was secretly involved in a land deal scandal, exploiting his position to benefit a shadowy network of real estate moguls. Furthermore, it accused Luffy of accepting substantial bribes to push environmentally damaging policies, a stark contradiction to his public persona.

However, the article, a vile concoction of lies, was not what had been approved by the newspaper's editor üòµ.

The Valdorian Times has hired you as a cyber incident responder to help investigate the incident and get to the bottom of how the falsified article was published.

---

### Run a take 10 on each of the tables to see what kind of data they contain.

![Desktop View](/assets/img/KQL101/1.png){: width="700" height="400" }


Now that we have access to the data, we'll need to get a lay of the land. Let's get some more information about the Valdorian Times.

---

### How many employees work at the Valdorian Times?

![Desktop View](/assets/img/KQL101/2.png){: width="700" height="400" }

---

We can use the where operator with the Employees table to find a specific employee.

Here is a template you can follow:

```KQL
Table
| where <field> <operator> <value>
```

---

### What is the Editorial Director's name?

![Desktop View](/assets/img/KQL101/3.png){: width="700" height="400" }

> **Note**  
> Email = **nene_leaks@valdoriantimes.news**
> Name = **Nene Leaks**
{: .note }

---

We can learn more about Nene Leaks using information from other tables. Let's take her email address from the Employees table and use it in a query for the Email table.

### How many emails did Nene Leaks receive?

![Desktop View](/assets/img/KQL101/4.png){: width="700" height="400" }

---

You can use the distinct operator to find unique values in a specific column.

### How many distinct senders were seen in the email logs from the domain name "weprinturstuff.com"?

![Desktop View](/assets/img/KQL101/5.png){: width="700" height="400" }

---

### How many distinct websites did ‚ÄúLois Lane‚Äù visit?

![Desktop View](/assets/img/KQL101/6.png){: width="700" height="400" }

![Desktop View](/assets/img/KQL101/7.png){: width="700" height="400" }

---

### How many distinct domains in the PassiveDns records contain the word ‚Äúhire‚Äù?

---

![Desktop View](/assets/img/KQL101/8.png){: width="700" height="400" }

---

### What IPs did the domain ‚Äújobhire.org‚Äù resolve to (enter any one of them)?

![Desktop View](/assets/img/KQL101/9.png){: width="700" height="400" }

---

### How many distinct websites did employees with the first name "Mary" Visit?

![Desktop View](/assets/img/KQL101/10.png){: width="700" height="400" }

---

### How many authentication attempts did we see to the accounts of employees with the first name Mary?

![Desktop View](/assets/img/KQL101/11.png){: width="700" height="400" }

---

## Section 2: Welcome to Valdoria

1. As a first step, you reach out to the Editorial Director Nene Leaks to ask for more information

![Desktop View](/assets/img/KQL101/12.png){: width="700" height="400" }

### What is the Newspaper Printer's name?

`Clark Kent`

---

### What is the Editorial Intern's name?

![Desktop View](/assets/img/KQL101/13.png){: width="700" height="400" }

`Ronnie McLovin`

---

### When was the Editorial Intern hired at The Valdorian Times?

`1/2/2024, 8:00:00 AM`

---

![Desktop View](/assets/img/KQL101/14.png){: width="700" height="400" }













